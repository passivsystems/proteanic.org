<html>
  <body data-sw-nav="Tutorial" data-sw-priority="2">
    <div class="row">
      <div class="col-md-4">
        <div data-sw-component="menu" data-sw-source="sw/bookmarks/tutorial">Placeholder for menu</div>
      </div>
      <div class="col-md-8" role="main">
        <div class="page-header">
          <h1>Tutorial</h1>
        </div>

        <section data-sw-nav="Overview" id="tut-overview" data-sw-content>
          <div class="page-header">
            <h2>Overview</h2>
          </div>
          <p class="lead">A progressive tutorial</p>

          <p>
            This is a progressive tutorial designed to gradually demonstrate the main features of Protean.
            It is aimed to be fun so each part will follow on from the previous, the aim being to build an
            online text adventure game driven by a RESTful API for exploring it, and building it.
          </p>
        </section>

        <section data-sw-nav="Part 1 - encoding (basics)" id="tut-part-1" data-sw-content>
          <div class="page-header">
            <h2>Part 1 - Encoding</h2>
          </div>
          <p class="lead">The basics</p>

          <pre class="prettyprint">
{
  :includes ["defaults.edn"]

  :title "Tutorial 1"

  "tutorial-1" {"play" {:get {}}}
}
          </pre>

          <h3><span class="glyphicon glyphicon-info-sign" /> Explanation</h3>
          <p>This is just about the simplest codex.  Out of this we get :</p>
          <ul>
            <li>an endpoint <code>tutorial-1/play</code></li>
            <li>a <code>get</code> method</li>
            <li>a nice title for the api docs</li>
            <li>some free preferences for response status codes in 'defaults.edn'</li>
          </ul>

          <h3><span class="glyphicon glyphicon-play" /> Run it</h3>
          <p>We will start with creating the apidocs for the service defined in this tutorial.</p>
          <ol>
            <li>
              copy <code>tutorial-1.cod.edn</code> from <code>public/tutorial</code> to your codex directory
            </li>
            <li>
              enter <code><kbd>lein run visit -f tutorial-1.cod.edn -b '{"locs":["tutorial-1"], "commands":["doc"], "directory":"silk_templates/data/protean-api"}'</kbd></code>
            </li>
            <li>
              open the <code>index.html</code> file created in <code>silk_templates/site</code>
            </li>
          </ol>
        </section>

        <section data-sw-nav="Part 2 - encoding (docs/types)" id="tut-part-2" data-sw-content>
          <div class="page-header">
            <h2>Part 2 - Encoding</h2>
          </div>
          <p class="lead">Documentation and types</p>

          <pre class="prettyprint">
{
  :includes ["defaults.edn"]

  :title "Tutorial 2"

  "tutorial-2" {
    "play/${stateId}" {
      :get {
        :doc "A single player REST adventure world"
        :description
"A simple text adventure world for one player.

Sample usage may be something like /tutorial-2/play/cave, indicating the player
is in a cave."
        :vars {
          "stateId" {:type :Int :doc "ID for the state of the game"}
        }
        :rsp {
          :404 {:doc "Not Found"}
        }
      }
    }
  }
}
          </pre>

          <h3><span class="glyphicon glyphicon-info-sign" /> Explanation</h3>
          <p>This adds a few things to the previous codex definition :</p>
          <ul>
            <li>a path parameter <code>stateId</code></li>
            <li>a simple doc string</li>
            <li>a multiline description for providing semantic information</li>
            <li>some variable information defining the type of the path parameter</li>
            <li>a 404 (Not Found) error response</li>
          </ul>

          <h3><span class="glyphicon glyphicon-play" /> Run it</h3>
          <p>Create your apidocs again.</p>
          <ol>
            <li>
              copy <code>tutorial-2.cod.edn</code> from <code>public/tutorial</code> to your codex directory
            </li>
            <li>
              enter <code><kbd>lein run visit -f tutorial-2.cod.edn -b '{"locs":["tutorial-2"], "commands":["doc"], "directory":"silk_templates/data/protean-api"}'</kbd></code>
            </li>
            <li>
              open the <code>index.html</code> file created in <code>silk_templates/site</code>
            </li>
          </ol>
        </section>

        <section data-sw-nav="Part 3 - encoding (response bodies)" id="tut-part-3" data-sw-content>
          <div class="page-header">
            <h2>Part 3 - Encoding</h2>
          </div>
          <p class="lead">Response bodies</p>

          <pre class="prettyprint">
{
  :includes ["defaults.edn"]

  :title "Tutorial 3"

  "tutorial-3" {
    "play/${stateId}" {
      :get {
        :doc "A single player REST adventure world"
        :description
"A simple text adventure world for one player.

Sample usage may be something like /tutorial-3/play/cave, indicating the player
is in a cave."
        :vars {
          "stateId" {:type :Int :doc "ID for the state of the game"}
        }
        :rsp {
          :200 {
            :doc "OK"
            :body-example "test-data/content/tutorial/tutorial-3/200-ref.json"
          }
          :503 {
            :doc "Service Unavailable"
            :headers {"Content-Type" "application/problem+json" "Content-Language" "en"}
            :body-example "test-data/content/tutorial/tutorial-3/lazy-server-gremlins.json"
          }
        }
      }
    }
  }
}
          </pre>

          <h3><span class="glyphicon glyphicon-info-sign" /> Explanation</h3>
          <p>We now add some new concepts to the previous codex definition :</p>
          <ul>
            <li>a response body for a 200 (OK) response</li>
            <li>overriding the response body content type for the 404 response</li>
          </ul>
          <p>
            Where it is possible for a response to have a body it is good practice to include a reference
            example in the codex.  It is entirely possible that an error response, like the 503 defined in this
            example could have a completely different body
          </p>


          <h3><span class="glyphicon glyphicon-play" /> Run it</h3>
          <p>Create your apidocs again.</p>
          <ol>
            <li>
              copy <code>tutorial-3.cod.edn</code> from <code>public/tutorial</code> to your codex directory
            </li>
            <li>
              enter <code><kbd>lein run visit -f tutorial-3.cod.edn -b '{"locs":["tutorial-3"], "commands":["doc"], "directory":"silk_templates/data/protean-api"}'</kbd></code>
            </li>
            <li>
              open the <code>index.html</code> file created in <code>silk_templates/site</code>
            </li>
          </ol>
        </section>

        <section data-sw-nav="Part 4 - simulation (basics)" id="tut-part-4" data-sw-content>
          <div class="page-header">
            <h2>Part 4 - Simulation</h2>
          </div>
          <p class="lead">The basics</p>

          <h3><span class="glyphicon glyphicon-info-sign" /> Explanation</h3>
          <p>You do not need to do anything to get a basic simulation for free.  It has always been available.</p>

          <h3><span class="glyphicon glyphicon-play" /> Run it</h3>
          <p>Run the simulation, using the tutorial-3 codex which you have already copied into your codex directory.</p>
          <ol>
            <li>
              run <code><kbd>protean-server</kbd></code>
            </li>
            <li>
              run <code><kbd>protean services</kbd></code>
            </li>
            <li>
              run <code><kbd>protean service-usage -n tutorial-3</kbd></code>
            </li>
            <li>
              select the curl statement generated as output of the previous step and execute it
            </li>
          </ol>
          <p>
            You should see output like :
          </p>

          <pre class="prettyprint">
{
  "description": "You are in a cave, it is very dark"
}
          </pre>
        </section>
      </div>
    </div>
  </body>
</html>
